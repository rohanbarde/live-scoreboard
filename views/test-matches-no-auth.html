<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Tournament Matches (No Auth)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>Tournament Matches Test Page</h1>
        <div class="alert alert-info">
            This page tests the tournament matches functionality without authentication.
        </div>
        
        <div id="status" class="alert alert-secondary">
            Initializing...
        </div>
        
        <div id="deviceInfo" class="card mb-3">
            <div class="card-body">
                <h5>Device Information</h5>
                <div id="deviceDetails">Loading...</div>
            </div>
        </div>
        
        <div id="matchesInfo" class="card">
            <div class="card-body">
                <h5>Matches Information</h5>
                <div id="matchesDetails">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <!-- Firebase config -->
    <script src="../public/js/firebase.js"></script>
    
    <!-- Match Manager -->
    <script src="../public/js/match-manager.js"></script>
    
    <script>
        const statusEl = document.getElementById('status');
        const deviceDetailsEl = document.getElementById('deviceDetails');
        const matchesDetailsEl = document.getElementById('matchesDetails');
        
        // Wait for Firebase to initialize
        setTimeout(() => {
            try {
                statusEl.innerHTML = '✅ Firebase initialized';
                statusEl.className = 'alert alert-success';
                
                // Check if MatchManager is available
                if (typeof MatchManager !== 'undefined') {
                    deviceDetailsEl.innerHTML = `
                        <p><strong>Device ID:</strong> ${window.DEVICE_ID}</p>
                        <p><strong>Device Name:</strong> ${window.DEVICE_NAME || 'Not set'}</p>
                        <p><strong>MatchManager:</strong> ✅ Available</p>
                    `;
                    
                    // Try to create match manager instance
                    const matchManager = new MatchManager();
                    
                    // Listen for matches
                    matchManager.onMatchesUpdate(matches => {
                        matchesDetailsEl.innerHTML = `
                            <p><strong>Total Matches:</strong> ${matches.length}</p>
                            <p><strong>Status:</strong> ${matches.length > 0 ? '✅ Matches found' : '⚠️ No matches yet'}</p>
                            ${matches.length > 0 ? '<p><strong>First Match ID:</strong> ' + matches[0].id + '</p>' : ''}
                        `;
                    });
                    
                } else {
                    deviceDetailsEl.innerHTML = '<p class="text-danger">❌ MatchManager not available</p>';
                }
                
            } catch (error) {
                statusEl.innerHTML = '❌ Error: ' + error.message;
                statusEl.className = 'alert alert-danger';
                console.error('Error:', error);
            }
        }, 1000);
    </script>
</body>
</html>
